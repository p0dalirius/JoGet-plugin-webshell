# Missing requirement error while importing a plugin

If you encounter the following error in the JoGet workflow logs while importing a plugin:

```
ERROR 14 Mar 2022 21:37:26 org.joget.plugin.base.PluginManager - Failed bundle start for org.joget.webshell [1]: org.osgi.framework.BundleException: Unable to resolve org.joget.webshell [1](R 1.1): missing requirement [org.joget.webshell [1](R 1.1)] osgi.wiring.package; (&(osgi.wiring.package=javax.servlet)(version>=3.0.0)(!(version>=4.0.0))) Unresolved requirements: [[org.joget.webshell [1](R 1.1)] osgi.wiring.package; (&(osgi.wiring.package=javax.servlet)(version>=3.0.0)(!(version>=4.0.0)))]
org.osgi.framework.BundleException: Unable to resolve org.joget.webshell [1](R 1.1): missing requirement [org.joget.webshell [1](R 1.1)] osgi.wiring.package; (&(osgi.wiring.package=javax.servlet)(version>=3.0.0)(!(version>=4.0.0))) Unresolved requirements: [[org.joget.webshell [1](R 1.1)] osgi.wiring.package; (&(osgi.wiring.package=javax.servlet)(version>=3.0.0)(!(version>=4.0.0)))]
	at org.apache.felix.framework.Felix.resolveBundleRevision(Felix.java:4368) ~[org.apache.felix.main-6.0.2.jar:?]
	...
	at java.lang.Thread.run(Thread.java:829) [?:?]
INFO  14 Mar 2022 21:37:27 org.joget.plugin.base.PluginManager - admin installed plugin (webshell-1.0.jar).
ERROR 14 Mar 2022 21:37:27 org.joget.plugin.base.PluginManager - Failed bundle start for org.joget.webshell [1]: org.osgi.framework.BundleException: Unable to resolve org.joget.webshell [1](R 1.2): missing requirement [org.joget.webshell [1](R 1.2)] osgi.wiring.package; (&(osgi.wiring.package=javax.servlet)(version>=3.0.0)(!(version>=4.0.0))) Unresolved requirements: [[org.joget.webshell [1](R 1.2)] osgi.wiring.package; (&(osgi.wiring.package=javax.servlet)(version>=3.0.0)(!(version>=4.0.0)))]
org.osgi.framework.BundleException: Unable to resolve org.joget.webshell [1](R 1.2): missing requirement [org.joget.webshell [1](R 1.2)] osgi.wiring.package; (&(osgi.wiring.package=javax.servlet)(version>=3.0.0)(!(version>=4.0.0))) Unresolved requirements: [[org.joget.webshell [1](R 1.2)] osgi.wiring.package; (&(osgi.wiring.package=javax.servlet)(version>=3.0.0)(!(version>=4.0.0)))]
	at org.apache.felix.framework.Felix.resolveBundleRevision(Felix.java:4368) ~[org.apache.felix.main-6.0.2.jar:?]
	...
	at java.lang.Thread.run(Thread.java:829) [?:?]
INFO  14 Mar 2022 21:37:27 org.joget.plugin.base.PluginManager - Installed plugin webshell-1.0.jar
```

This means the application cannot satisfy the requirement `(&(osgi.wiring.package=javax.servlet)(version>=3.0.0)(!(version>=4.0.0)))`, that is `javax.servlet` version in [3.0.0, 3.x.x] (but not the 4.0.0).

This error happens because the MANIFEST.MF generated by maven is wrong:

```
Manifest-Version: 1.0
Bnd-LastModified: 1647246564211
Build-Jdk-Spec: 11
Bundle-Activator: sample.Activator
Bundle-ClassPath: .,dependency/servlet-api-2.3.jar,dependency/jsp-api-
 2.0.jar,dependency/json-20080701.jar,dependency/commons-collections-3
 .2.1.jar,dependency/commons-lang-2.5.jar
Bundle-ManifestVersion: 2
Bundle-Name: sample
Bundle-SymbolicName: sample
Bundle-Version: 1.0.0
Created-By: Apache Maven Bundle Plugin 5.1.4
DynamicImport-Package: *
Embed-Dependency: *;scope=compile|runtime;inline=false
Embed-Directory: dependency
Embed-StripGroup: true
Embed-Transitive: true
Embedded-Artifacts: dependency/servlet-api-2.3.jar;g="javax.servlet";a
 ="servlet-api";v="2.3",dependency/jsp-api-2.0.jar;g="javax.servlet";a
 ="jsp-api";v="2.0",dependency/json-20080701.jar;g="org.json";a="json"
 ;v="20080701",dependency/commons-collections-3.2.1.jar;g="commons-col
 lections";a="commons-collections";v="3.2.1",dependency/commons-lang-2
 .5.jar;g="commons-lang";a="commons-lang";v="2.5"
Export-Package: sample;uses:="javax.servlet,javax.servlet.http,org.jog
 et.plugin.base,org.osgi.framework";version="1.0.0"
Import-Package: org.joget.report.dao,org.joget.report.model,org.joget.
 report.service,org.joget.commons.util,org.joget.plugin.base,org.joget
 .plugin.property.model,org.joget.plugin.property.service,org.joget.di
 rectory.model,org.joget.directory.model.service,org.joget.directory.d
 ao,org.joget.workflow.model,org.joget.workflow.model.dao,org.joget.wo
 rkflow.model.service,org.joget.workflow.util,org.joget.apps.app.dao,o
 rg.joget.apps.app.lib,org.joget.apps.app.model,org.joget.apps.app.ser
 vice,org.joget.apps.datalist.lib,org.joget.apps.datalist.model,org.jo
 get.apps.datalist.service,org.joget.apps.form.lib,org.joget.apps.form
 .dao,org.joget.apps.form.model,org.joget.apps.form.service,org.joget.
 apps.list.service,org.joget.apps.userview.lib,org.joget.apps.userview
 .model,org.joget.apps.userview.service,org.joget.apps.workflow.lib,ja
 vax.servlet;version="[3.0,4)",javax.servlet.http;version="[3.0,4)",or
 g.osgi.framework;version="1.3.0"
Require-Capability: osgi.ee;filter:="(&(osgi.ee=JavaSE)(version=1.7))"
Tool: Bnd-5.1.1.202006162103
```

As we can see, the `Import-Package` contains specific versions of `javax.servlet;version="[3.0,4)"` and `javax.servlet.http;version="[3.0,4)"`. Therefore we need to remove these versions to get the following MANIFEST.MF:

```
Manifest-Version: 1.0
Bnd-LastModified: 1647246564211
Build-Jdk-Spec: 11
Bundle-Activator: sample.Activator
Bundle-ClassPath: .,dependency/servlet-api-2.3.jar,dependency/jsp-api-
 2.0.jar,dependency/json-20080701.jar,dependency/commons-collections-3
 .2.1.jar,dependency/commons-lang-2.5.jar
Bundle-ManifestVersion: 2
Bundle-Name: sample
Bundle-SymbolicName: sample
Bundle-Version: 1.0.0
Created-By: Apache Maven Bundle Plugin 5.1.4
DynamicImport-Package: *
Embed-Dependency: *;scope=compile|runtime;inline=false
Embed-Directory: dependency
Embed-StripGroup: true
Embed-Transitive: true
Embedded-Artifacts: dependency/servlet-api-2.3.jar;g="javax.servlet";a
 ="servlet-api";v="2.3",dependency/jsp-api-2.0.jar;g="javax.servlet";a
 ="jsp-api";v="2.0",dependency/json-20080701.jar;g="org.json";a="json"
 ;v="20080701",dependency/commons-collections-3.2.1.jar;g="commons-col
 lections";a="commons-collections";v="3.2.1",dependency/commons-lang-2
 .5.jar;g="commons-lang";a="commons-lang";v="2.5"
Export-Package: sample;uses:="javax.servlet,javax.servlet.http,org.jog
 et.plugin.base,org.osgi.framework";version="1.0.0"
Import-Package: org.joget.report.dao,org.joget.report.model,org.joget.
 report.service,org.joget.commons.util,org.joget.plugin.base,org.joget
 .plugin.property.model,org.joget.plugin.property.service,org.joget.di
 rectory.model,org.joget.directory.model.service,org.joget.directory.d
 ao,org.joget.workflow.model,org.joget.workflow.model.dao,org.joget.wo
 rkflow.model.service,org.joget.workflow.util,org.joget.apps.app.dao,o
 rg.joget.apps.app.lib,org.joget.apps.app.model,org.joget.apps.app.ser
 vice,org.joget.apps.datalist.lib,org.joget.apps.datalist.model,org.jo
 get.apps.datalist.service,org.joget.apps.form.lib,org.joget.apps.form
 .dao,org.joget.apps.form.model,org.joget.apps.form.service,org.joget.
 apps.list.service,org.joget.apps.userview.lib,org.joget.apps.userview
 .model,org.joget.apps.userview.service,org.joget.apps.workflow.lib,ja
 vax.servlet,javax.servlet.http,or
 g.osgi.framework;version="1.3.0"
Require-Capability: osgi.ee;filter:="(&(osgi.ee=JavaSE)(version=1.7))"
Tool: Bnd-5.1.1.202006162103
```

We're still working on a fix, but in the meantime you can do this patching automatically with the [patch.sh](../dev_env/patch.sh).

Now we can import the plugin in JoGet without problems!

## References
 - https://thecarlhall.wordpress.com/2012/01/19/understanding-the-unresolved-constraint-missing-resource-message-from-apache-felix/
 - https://thecarlhall.wordpress.com/2012/07/11/understanding-the-unresolved-constraint-missing-requirement-message-from-apache-felix-pt-2/
